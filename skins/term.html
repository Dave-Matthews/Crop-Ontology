<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en">
<head>
    <title>{{term_name}}</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/reset-fonts-grids.css" media="all" /> 
    <link rel="stylesheet" type="text/css" href="/stylesheets/resume.css" media="all" />
<script type="text/javascript" src="/js/jquery.min.1.5.2.js"></script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9565684-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<script>
var term_name = "{{term_name}}";
var term_id = "{{term_id}}";
$(function(){

function markdown(str) {
    function replaceURLWithHTMLLinks(text) {
        var exp = /(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
        return text.replace(exp,"<a href='$1'>$1</a>"); 
    }
    var str = ""+str;
    str = str.replace(new RegExp("(\n)\\1+","g"), "<br /><br />").replace(new RegExp("\n", "g"),"<br />");
    str = str.replace(/\\n/g, "<br />");
    str = replaceURLWithHTMLLinks(str);
    // do gramene links
    str = str.replace(/TO\\?:(\d+)/g, function() {
        var id = "TO:" + arguments[1];
        return "<a target='_blank' href='http://www.gramene.org/db/ontology/search?id="+id+"'>" + id + "</a>"
    }); // replace TO:\ with TO:
    return str;
}
function loader(show) {
    if(show)
        $(".loader").show();
    else
        $(".loader").hide();
}

function show_attributes(attributes) {
    $.each(attributes, function(i) {
        $(".yui-b").append('\
            <div class="yui-gf">\
                <div class="yui-u first">\
                    <h2>'+this.key+'</h2>\
                </div>\
                <div class="yui-u">\
                    <p class="enlarge">'+markdown(this.value)+'</p>\
                    <p id="languages" class="enlarge"></p>\
                </div>\
            </div>\
        ');

    });
}

// load all the attributes retrieved from the ols (XML)
function load_ols(func) {
    loader(true);
    $.getJSON("/get-attributes/"+term_id, function(attributes) {

        // let's show the attributes
        show_attributes(attributes);
        loader(false);
    });
}

// START


load_ols();

});

</script>

<style>
.yui-gc div.first, .yui-gd .yui-u {
    width: 100%;
}
#ft {
    border: 0;
}
#hd h1 {
    font-size: 20px;
}
img {
    max-width: 500px;
}
.yui-u {
    word-wrap: break-word;
    
}
</style>
</head>
<body id="resume">
<div class="yui-t7" id="doc2">
    <div id="inner">

        <div id="hd">
            <div class="yui-gc">
                <div class="yui-u first">
                    <hgroup>
                        <h1>{{term_name}}</h1>
                        <h2></h2>
                    </hgroup>
                </div>
                <div class="yui-u">
                    <div class="contact-info">
                        <a target="_blank" href="http://www.cropontology-curationtool.org" title="Crop Ontology Curation Tool">Crop Ontology Curation Tool</a>
                        <h3><a target="_blank" href="http://www.cropontology-curationtool.org/terms/{{term_id}}/{{term_name}}" title="{{ontology_name}}" class="email">{{ontology_name}}</a></h3></div><!--// .contact-info -->
                </div>

            </div><!--// .yui-gc -->
        </div><!--// hd -->

        <div id="bd">
            <div id="yui-main">
                <div class="yui-b">
                    <img src="/images/metabox_loader.gif" class="loader" style="display: none" />
                </div><!--// .yui-b -->
            </div><!--// yui-main -->
        </div><!--// bd -->


    </div><!-- // inner -->

</div>
</body>
</html>

